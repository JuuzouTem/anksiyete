<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anksiyete</title>
    <style>
        :root {
            --pulse-duration: 8s;
            --vignette-size: 0px;
            --screen-filter: none;
            --crack-opacity: 0;
            --breath-intensity: 1;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #080808;
            color: #ccc;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            transition: filter 5s ease-in-out;
            filter: var(--screen-filter);
        }

        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            box-shadow: inset 0 0 var(--vignette-size) var(--vignette-size) #000;
            pointer-events: none;
            z-index: 100;
            transition: box-shadow 4s ease-out;
        }

        body.shaking {
            animation: shake 0.3s infinite;
        }

        body.intense-shaking {
            animation: intenseShake 0.1s infinite;
        }

        #intro {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
            color: #777;
            cursor: pointer;
            z-index: 200;
            transition: opacity 1s, color 1s;
        }
        
        #intro:hover {
            color: #aaa;
        }

        #anxiety-core {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50vmax;
            height: 50vmax;
            background: radial-gradient(circle, rgba(50, 50, 55, 0.4) 0%, rgba(0,0,0,0) 70%);
            border-radius: 50%;
            opacity: 0;
            animation: pulse var(--pulse-duration) infinite ease-in-out alternate,
                       jitter 10s infinite linear;
            transition: opacity 5s;
            filter: brightness(1);
        }

        #anxiety-core.cracking::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(45deg, transparent 40%, rgba(255,0,0,0.1) 41%, transparent 42%),
                linear-gradient(-45deg, transparent 35%, rgba(255,0,0,0.08) 36%, transparent 37%),
                linear-gradient(90deg, transparent 45%, rgba(255,0,0,0.05) 46%, transparent 47%);
            opacity: var(--crack-opacity);
            animation: crackPulse 0.5s infinite;
        }

        #word-test {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            opacity: 0;
            transition: opacity 1s;
            z-index: 150;
        }

        #target-word {
            font-size: 2rem;
            color: #999;
            margin-bottom: 20px;
            letter-spacing: 2px;
            transition: all 0.3s;
        }

        #target-word.distorted {
            animation: distort 0.5s infinite;
            color: #666;
        }

        #word-input {
            padding: 10px 20px;
            font-size: 1.5rem;
            background: transparent;
            border: 1px solid #444;
            color: #ccc;
            text-align: center;
            transition: all 0.3s;
            outline: none;
        }

        #word-input.moving {
            animation: inputMove 2s infinite;
        }

        #word-input:focus {
            border-color: #666;
        }

        #timer {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #555;
            opacity: 0;
            transition: opacity 0.5s, color 0.3s;
        }

        #timer.urgent {
            color: #a44;
            animation: timerPulse 0.5s infinite;
        }

        #whispers-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .whisper {
            position: absolute;
            color: #444;
            font-size: 1rem;
            opacity: 0;
            filter: blur(1px);
            transition: opacity 3s;
            pointer-events: none;
        }

        .whisper.visible {
            opacity: 1;
        }

        .whisper.hate {
            color: #633;
            font-size: 1.2rem;
            filter: blur(0.5px);
            animation: hatePulse 2s infinite;
        }

        .thought-stream {
            position: absolute;
            color: #666;
            font-size: 0.9rem;
            white-space: nowrap;
            opacity: 0;
            animation: thoughtFlow 5s linear;
            pointer-events: none;
        }

        #breather {
            position: absolute;
            color: #555;
            font-size: 1rem;
            opacity: 0;
            z-index: 201;
            transition: opacity 2s, color 0.3s, border-color 0.3s;
            border: 1px solid #444;
            padding: 10px 20px;
            cursor: pointer;
            animation: breathShake calc(0.1s * var(--breath-intensity)) infinite;
        }

        #breather:hover {
            color: #999;
            border-color: #777;
        }

        .tingle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            pointer-events: none;
            animation: tingle 3s infinite;
        }

        #final-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            color: #888;
            opacity: 0;
            text-align: center;
            max-width: 80%;
            transition: opacity 3s;
            z-index: 300;
        }

        #eye-open {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            z-index: 500;
            pointer-events: none;
            clip-path: ellipse(0% 0% at 50% 50%);
            transition: clip-path 3s ease-in-out, background 3s ease-in-out;
        }

        #eye-open.opening {
            clip-path: ellipse(100% 100% at 50% 50%);
            background: #f5f5f5;
        }

        /* ANIMATIONS */
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(0.95); }
            100% { transform: translate(-50%, -50%) scale(1.05); }
        }

        @keyframes jitter {
            0%, 100% { transform: translate(-50%, -50%); }
            25% { transform: translate(-50.2%, -49.8%); }
            50% { transform: translate(-49.9%, -50.1%); }
            75% { transform: translate(-50.1%, -49.9%); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }

        @keyframes intenseShake {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-3px, 2px) rotate(-0.5deg); }
            50% { transform: translate(2px, -3px) rotate(0.5deg); }
            75% { transform: translate(-2px, -2px) rotate(-0.3deg); }
            100% { transform: translate(3px, 1px) rotate(0.3deg); }
        }

        @keyframes distort {
            0%, 100% { filter: blur(0px); transform: skew(0deg); }
            25% { filter: blur(1px); transform: skew(1deg); }
            50% { filter: blur(0.5px); transform: skew(-1deg); }
            75% { filter: blur(1.5px); transform: skew(0.5deg); }
        }

        @keyframes inputMove {
            0%, 100% { transform: translateX(0); }
            33% { transform: translateX(-10px); }
            66% { transform: translateX(10px); }
        }

        @keyframes timerPulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }

        @keyframes hatePulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        @keyframes thoughtFlow {
            0% { 
                transform: translateX(-100%); 
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% { 
                transform: translateX(calc(100% + 100vw)); 
                opacity: 0;
            }
        }

        @keyframes breathShake {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(-1px, 1px); }
            50% { transform: translate(1px, -1px); }
            75% { transform: translate(-1px, -1px); }
        }

        @keyframes crackPulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        @keyframes tingle {
            0% { 
                transform: translate(0, 0); 
                opacity: 0;
            }
            50% { 
                opacity: 0.3;
            }
            100% { 
                transform: translate(random() * 10px - 5px, random() * 10px - 5px); 
                opacity: 0;
            }
        }
    </style>
</head>
<body>

    <div id="intro">Tıkla.</div>
    
    <div id="anxiety-core"></div>
    
    <div id="word-test">
        <div id="target-word"></div>
        <input type="text" id="word-input" autocomplete="off" />
    </div>
    
    <div id="timer"></div>
    
    <div id="whispers-container"></div>
    
    <div id="breather">Nefes al.</div>
    
    <div id="final-message"></div>
    
    <div id="eye-open"></div>

    <script>
        const intro = document.getElementById('intro');
        const core = document.getElementById('anxiety-core');
        const wordTest = document.getElementById('word-test');
        const targetWord = document.getElementById('target-word');
        const wordInput = document.getElementById('word-input');
        const timer = document.getElementById('timer');
        const whispersContainer = document.getElementById('whispers-container');
        const breather = document.getElementById('breather');
        const finalMessage = document.getElementById('final-message');
        const eyeOpen = document.getElementById('eye-open');
        const body = document.body;
        const root = document.documentElement;

        let currentPhase = 'waiting';
        let anxietyLevel = 0;
        let mistakes = 0;
        let wordIndex = 0;
        let timeLimit = 5000;
        let timerInterval;
        let whisperInterval;
        let thoughtInterval;
        let manipulated = false;
        let breathClickRequired = 1;
        let breathClicks = 0;

        const testWords = ['kelime', 'düşünce', 'hata', 'korku', 'belirsiz', 'sonuç'];
        
        const whispers = [
            "Ya...?", "Yanlış yaparsan?", "Rezil olacaksın.", "Sana bakıyorlar.", 
            "Güldüler mi?", "Kesin kötü bir şey olacak.", "Unuttun mu?", 
            "Yeterli değil.", "Neden böyle söyledin?", "Tuhaf görünüyor.", 
            "Beceremeyeceksin.", "Herkes farkında.", "Kalbim...", "Nefes alamıyorum."
        ];

        const hateThoughts = [
            "Neden bu kadar basit bir şeyi yapamıyorsun?",
            "Herkes sana gülüyor.",
            "Asla başaramayacaksın.",
            "Bu kadar mı beceriksizsin?",
            "Kimse seni sevmiyor.",
            "Her şeyi mahvediyorsun.",
            "Değersizsin.",
            "Neden varsın ki?",
            "Başarısızlıktan başka bir şey değilsin.",
            "Herkes senin ne kadar yetersiz olduğunu görüyor."
        ];

        function startBreathing() {
            let breathSpeed = Math.max(8 - anxietyLevel, 2);
            root.style.setProperty('--pulse-duration', `${breathSpeed}s`);
        }

        function createWhisper(isHate = false) {
            const whisperEl = document.createElement('div');
            whisperEl.classList.add('whisper');
            if (isHate) whisperEl.classList.add('hate');
            
            const texts = isHate ? hateThoughts : whispers;
            whisperEl.innerText = texts[Math.floor(Math.random() * texts.length)];
            
            whisperEl.style.top = `${Math.random() * 90}%`;
            whisperEl.style.left = `${Math.random() * 90}%`;
            whisperEl.style.fontSize = isHate ? `${1.2 + Math.random() * 0.5}rem` : `${0.8 + Math.random() * 0.5}rem`;
            whisperEl.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;

            whispersContainer.appendChild(whisperEl);

            setTimeout(() => {
                whisperEl.classList.add('visible');
            }, 100);

            setTimeout(() => {
                whisperEl.style.opacity = '0';
                setTimeout(() => whisperEl.remove(), 3000);
            }, isHate ? 3000 : 8000);
        }

        function createThoughtStream() {
            const thought = document.createElement('div');
            thought.classList.add('thought-stream');
            thought.innerText = hateThoughts[Math.floor(Math.random() * hateThoughts.length)];
            thought.style.top = `${20 + Math.random() * 60}%`;
            
            whispersContainer.appendChild(thought);
            setTimeout(() => thought.remove(), 5000);
        }

        function createTingles() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const tingle = document.createElement('div');
                    tingle.classList.add('tingle');
                    tingle.style.left = `${Math.random() * 100}%`;
                    tingle.style.top = `${Math.random() * 100}%`;
                    document.body.appendChild(tingle);
                    setTimeout(() => tingle.remove(), 3000);
                }, i * 100);
            }
        }

        function distortWord() {
            const chars = targetWord.innerText.split('');
            const distortedChars = chars.map(char => {
                if (Math.random() > 0.7) {
                    const randomChar = String.fromCharCode(97 + Math.floor(Math.random() * 26));
                    return Math.random() > 0.5 ? randomChar.toUpperCase() : randomChar;
                }
                return char;
            });
            targetWord.innerText = distortedChars.join('');
            targetWord.classList.add('distorted');
        }

        function showBreather() {
            breather.style.opacity = '1';
            const positions = [
                { bottom: '5%', left: '50%' },
                { top: '10%', right: '10%' },
                { bottom: '10%', left: '10%' },
                { top: '50%', right: '5%' },
                { bottom: '20%', right: '20%' }
            ];
            
            const pos = positions[Math.floor(Math.random() * positions.length)];
            breather.style.top = pos.top || 'auto';
            breather.style.bottom = pos.bottom || 'auto';
            breather.style.left = pos.left || 'auto';
            breather.style.right = pos.right || 'auto';
            breather.style.transform = pos.left === '50%' ? 'translateX(-50%)' : 'none';
            
            root.style.setProperty('--breath-intensity', Math.min(10, anxietyLevel + 1));
        }

        function manipulateKeyboard(e) {
            if (!manipulated && wordIndex === testWords.length - 1) {
                const word = testWords[wordIndex];
                if (wordInput.value.length === word.length - 1) {
                    e.preventDefault();
                    wordInput.value += String.fromCharCode(97 + Math.floor(Math.random() * 26));
                    manipulated = true;
                    checkWord();
                }
            }
        }

        function startTimer() {
            let timeLeft = timeLimit;
            timer.style.opacity = '1';
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft -= anxietyLevel > 3 ? 200 : 100;
                timer.innerText = `${(timeLeft / 1000).toFixed(1)}s`;
                
                if (timeLeft <= 1000) {
                    timer.classList.add('urgent');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    checkWord(true);
                }
            }, 100);
        }

        function checkWord(timeout = false) {
            clearInterval(timerInterval);
            const correct = wordInput.value.toLowerCase() === testWords[wordIndex].toLowerCase();
            
            if (!correct || timeout) {
                mistakes++;
                anxietyLevel++;
                createWhisper(true);
                
                if (mistakes > 3) {
                    root.style.setProperty('--crack-opacity', Math.min(1, mistakes * 0.2));
                    core.classList.add('cracking');
                }
                
                if (anxietyLevel > 3) {
                    body.classList.add('shaking');
                    distortWord();
                    wordInput.classList.add('moving');
                }
                
                if (anxietyLevel > 5) {
                    whisperInterval = setInterval(() => createWhisper(true), 1000);
                }
                
                showBreather();
                breathClickRequired = Math.min(5, Math.floor(anxietyLevel / 2) + 1);
                wordTest.style.opacity = '0';
                currentPhase = 'breathing';
                return;
            }
            
            nextWord();
        }

        function nextWord() {
            wordIndex++;
            
            if (wordIndex >= testWords.length || manipulated) {
                escalateAnxiety();
                return;
            }
            
            wordInput.value = '';
            targetWord.innerText = testWords[wordIndex];
            timeLimit = Math.max(1500, 5000 - (wordIndex * 500));
            
            if (anxietyLevel > 2) {
                setTimeout(distortWord, Math.random() * 2000);
            }
            
            startTimer();
        }

        function escalateAnxiety() {
            currentPhase = 'escalation';
            wordTest.style.opacity = '0';
            timer.style.opacity = '0';
            
            body.classList.add('intense-shaking');
            root.style.setProperty('--pulse-duration', '0.5s');
            root.style.setProperty('--vignette-size', '300px');
            root.style.setProperty('--screen-filter', 'grayscale(90%) contrast(150%) brightness(0.7)');
            
            thoughtInterval = setInterval(createThoughtStream, mistakes > 0 ? 500 : 1000);
            whisperInterval = setInterval(() => createWhisper(true), 300);
            
            createTingles();
            
            setTimeout(() => {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const quickWord = document.createElement('div');
                        quickWord.style.position = 'absolute';
                        quickWord.style.top = `${30 + Math.random() * 40}%`;
                        quickWord.style.left = `${10 + Math.random() * 80}%`;
                        quickWord.style.color = '#a44';
                        quickWord.style.fontSize = '2rem';
                        quickWord.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                        quickWord.innerText = testWords[Math.floor(Math.random() * testWords.length)];
                        quickWord.style.animation = 'hatePulse 0.5s infinite';
                        document.body.appendChild(quickWord);
                        
                        setTimeout(() => quickWord.remove(), 2000);
                    }, i * 500);
                }
            }, 3000);
            
            setTimeout(showFinalMessage, 15000);
        }

        function showFinalMessage() {
            clearInterval(thoughtInterval);
            clearInterval(whisperInterval);
            
            document.querySelectorAll('.whisper, .thought-stream, .tingle').forEach(el => {
                el.style.opacity = '0';
                setTimeout(() => el.remove(), 1000);
            });
            
            body.className = '';
            wordTest.style.display = 'none';
            timer.style.display = 'none';
            
            finalMessage.innerText = "Bazen en büyük savaşlar, kimsenin görmediği yerde verilir.";
            finalMessage.style.opacity = '1';
            
            setTimeout(() => {
                finalMessage.style.opacity = '0';
                setTimeout(beginCalming, 3000);
            }, 5000);
        }

        function beginCalming() {
            currentPhase = 'calming';
            root.style.setProperty('--breath-intensity', 10);
            showBreather();
            breathClickRequired = 10;
            breathClicks = 0;
        }

        function handleBreatherClick() {
            if (currentPhase === 'breathing') {
                breathClicks++;
                if (breathClicks >= breathClickRequired) {
                    breathClicks = 0;
                    breather.style.opacity = '0';
                    wordTest.style.opacity = '1';
                    wordInput.focus();
                    nextWord();
                }
            } else if (currentPhase === 'calming') {
                breathClicks++;
                const intensity = Math.max(1, 10 - breathClicks);
                root.style.setProperty('--breath-intensity', intensity);
                
                if (breathClicks >= 10) {
                    breather.style.opacity = '0';
                    setTimeout(() => {
                        eyeOpen.classList.add('opening');
                        setTimeout(() => {
                            root.style.setProperty('--pulse-duration', '20s');
                            root.style.setProperty('--vignette-size', '0px');
                            root.style.setProperty('--screen-filter', 'none');
                            core.style.opacity = '0.2';
                            core.style.filter = 'brightness(0.5)';
                            
                            setTimeout(() => {
                                eyeOpen.style.display = 'none';
                            }, 3000);
                        }, 1000);
                    }, 1000);
                }
            }
        }

        function startExperience() {
            currentPhase = 'starting';
            intro.style.opacity = '0';
            setTimeout(() => intro.style.display = 'none', 1000);
            
            startBreathing();
            
            setTimeout(() => {
                core.style.opacity = '1';
                root.style.setProperty('--pulse-duration', '6s');
            }, 2000);
            
            setTimeout(() => {
                wordTest.style.opacity = '1';
                targetWord.innerText = testWords[0];
                wordInput.focus();
                startTimer();
                currentPhase = 'testing';
            }, 5000);
        }

        intro.addEventListener('click', startExperience);
        breather.addEventListener('click', handleBreatherClick);
        wordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkWord();
            }
            manipulateKeyboard(e);
        });

        wordInput.addEventListener('input', manipulateKeyboard);
    </script>
</body>
</html>